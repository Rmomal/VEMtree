<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network inference with missing actors â€¢ nestor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Network inference with missing actors">
<meta property="og:description" content="VEMtree runs a variational inference using an average on spanning trees to infer the conditional dependency structure from abundance data, while accounting for missing actors.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">nestor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Rmomal/nestor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="nestor-network-inference-from-species-counts-with-missing-actors-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#nestor-network-inference-from-species-counts-with-missing-actors-" class="anchor"></a>nestor: Network inference from Species counTs with missing actORs.</h1></div>
<!-- badges: start -->

<blockquote>
<p><code>nestor</code> is an R package for the inference of species interaction networks from their observed abundances, while accounting for possible unobserved missing actors in the data. It is an implementation of the tree-based VEM algorithm described in the preprint <a href="http://arxiv.org/abs/2007.14299" class="uri">http://arxiv.org/abs/2007.14299</a>.</p>
</blockquote>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div id="emtree-dependency" class="section level3">
<h3 class="hasAnchor">
<a href="#emtree-dependency" class="anchor"></a>EMtree dependency</h3>
<p><code>nestor</code> uses functions from the R package <code>EMtree</code> which development version is available from <a href="https://github.com/">GitHub</a></p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"Rmomal/EMtree"</span>)</pre></div>
</div>
<div id="cran-dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#cran-dependencies" class="anchor"></a>CRAN dependencies</h3>
<div class="sourceCode" id="cb2"><pre class="r"><span class="no">required_CRAN</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"utils"</span>, <span class="st">"stats"</span>, <span class="st">"ROCR"</span>,<span class="st">"graphics"</span>, <span class="st">"mvtnorm"</span>, <span class="st">"parallel"</span>,
                   <span class="st">"gridExtra"</span>, <span class="st">"reshape2"</span>  ,<span class="st">"ggplot2"</span>, <span class="st">"magrittr"</span>, <span class="st">"dplyr"</span>,
                   <span class="st">"tidyr"</span>, <span class="st">"tibble"</span>, <span class="st">"blockmodels"</span>, <span class="st">"mclust"</span>, <span class="st">"PLNmodels"</span>)
<span class="no">not_installed_CRAN</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="no">required_CRAN</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>()))
<span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">not_installed_CRAN</span>) <span class="kw">&gt;</span> <span class="fl">0</span>) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="no">not_installed_CRAN</span>)</pre></div>
</div>
<div id="installation-of-nestor" class="section level3">
<h3 class="hasAnchor">
<a href="#installation-of-nestor" class="anchor"></a>Installation of <code>nestor</code>
</h3>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"Rmomal/nestor"</span>)</pre></div>
</div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><code>nestor</code>simulates data with the function <code><a href="reference/missing_from_scratch.html">missing_from_scratch()</a></code>, which requires the desired type of dependency structure (scale-free, erdos or cluster) and the number of missing actors <code>r</code>. Here is an example with <code>r=1</code>for the scale-free structure:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nestor</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">data</span><span class="kw">=</span><span class="fu"><a href="reference/missing_from_scratch.html">missing_from_scratch</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">100</span>,<span class="kw">p</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">r</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"scale-free"</span>, <span class="kw">plot</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="30%" style="display: block; margin: auto;"></p>
<p>The original clique of the missing actor neighbors is available in the value <code>TC</code>:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">data</span>$<span class="no">TC</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 1 2 3 6</span></pre></div>
<p>The data is then prepared for analysis with the first step of the procedure: fit the PLN model. The <code><a href="reference/norm_PLN.html">norm_PLN()</a></code>function is a wraper to <code><a href="https://rdrr.io/pkg/PLNmodels/man/PLN.html">PLNmodels::PLN()</a></code> which normalizes all the necessary outputs, namely the means, variance and correlation matrices of the model latent Gaussian layer corresponding to observed species.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">PLNfit</span><span class="kw">&lt;-</span><span class="fu"><a href="reference/norm_PLN.html">norm_PLN</a></span>(<span class="no">data</span>$<span class="no">Y</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Initialization...</span>
<span class="co">#&gt;  Adjusting a PLN model with full covariance model</span>
<span class="co">#&gt;  Post-treatments...</span>
<span class="co">#&gt;  DONE!</span>
<span class="no">MO</span><span class="kw">&lt;-</span><span class="no">PLNfit</span>$<span class="no">MO</span>
<span class="no">SO</span><span class="kw">&lt;-</span><span class="no">PLNfit</span>$<span class="no">SO</span>
<span class="no">sigma_obs</span><span class="kw">=</span><span class="no">PLNfit</span>$<span class="no">sigma_obs</span></pre></div>
<p><code>nestor</code> then needs to be initialized. This requires to find an initial clique of neighbors for the missing actor:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">initClique</span><span class="kw">=</span> <span class="fu"><a href="reference/FitSparsePCA.html">FitSparsePCA</a></span>(<span class="no">data</span>$<span class="no">Y</span>,<span class="kw">r</span><span class="kw">=</span><span class="fl">1</span>)$<span class="no">cliques</span></pre></div>
<p>or a list of several possible cliques, for example using <code><a href="reference/complement_spca.html">complement_spca()</a></code>. The <code>nestor</code> package also provides with a bootstraped version of sPCA <code><a href="reference/boot_FitSparsePCA.html">boot_FitSparsePCA()</a></code>, and the function <code><a href="reference/init_blockmodels.html">init_blockmodels()</a></code> which uses package <code>blockmodels</code>.</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">six_cliques</span><span class="kw">=</span> <span class="fu"><a href="reference/complement_spca.html">complement_spca</a></span>(<span class="no">data</span>$<span class="no">Y</span>, <span class="kw">k</span><span class="kw">=</span><span class="fl">3</span>)
<span class="no">six_cliques</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt; [1] 3 6 8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]][[1]]</span>
<span class="co">#&gt; [1] 2 9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [[3]][[1]]</span>
<span class="co">#&gt; [1]  9 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [[4]][[1]]</span>
<span class="co">#&gt; [1]  1  2  4  5  7  9 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [[5]][[1]]</span>
<span class="co">#&gt; [1]  1  3  4  5  6  7  8 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt; [[6]][[1]]</span>
<span class="co">#&gt; [1] 1 2 3 4 5 6 7 8</span></pre></div>
<p>Once an initial clique has been found, the algorithm can be initialized.This is the aim of the function <code><a href="reference/initVEM.html">initVEM()</a></code>, which initializes all required parameters. This function builds one initialization from one initial clique. In this example we run the oracle procedure: the initialization is done with the true clique.</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">initList</span><span class="kw">=</span><span class="fu"><a href="reference/initVEM.html">initVEM</a></span>(<span class="no">data</span>$<span class="no">Y</span>,<span class="kw">cliqueList</span><span class="kw">=</span><span class="no">data</span>$<span class="no">TC</span>,<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov2cor</a></span>(<span class="no">sigma_obs</span>), <span class="no">MO</span>,<span class="kw">r</span><span class="kw">=</span><span class="fl">1</span> )
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">initList</span>)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ Wginit   : num [1:11, 1:11] 0 0.00826 0.00826 0.00826 0.00826 ...</span>
<span class="co">#&gt;  $ Winit    : num [1:11, 1:11] 0 0.00826 0.00826 0.00826 0.00826 ...</span>
<span class="co">#&gt;  $ omegainit: num [1:11, 1:11] 3.4633 1.2964 1.9354 0.7364 -0.0652 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:11] "Y1" "Y2" "Y3" "Y4" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:11] "Y1" "Y2" "Y3" "Y4" ...</span>
<span class="co">#&gt;  $ MHinit   : num [1:100, 1] 0.368 0.248 -0.404 -0.802 -1.893 ...</span></pre></div>
<p>The core function <code><a href="https://rdrr.io/pkg/nestor/man/nestor-package.html">nestor()</a></code> can now be run as follows:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">fit</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/nestor/man/nestor-package.html">nestor</a></span>(<span class="no">data</span>$<span class="no">Y</span>, <span class="no">MO</span>,<span class="no">SO</span>, <span class="kw">initList</span><span class="kw">=</span><span class="no">initList</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.1</span>,<span class="kw">eps</span><span class="kw">=</span><span class="fl">1e-3</span>,
           <span class="kw">maxIter</span><span class="kw">=</span><span class="fl">30</span>,<span class="kw">verbatim</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">trackJ</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></div>
<p>This package contains several visualization functions. <code><a href="reference/plotPerf.html">plotPerf()</a></code> gives a quick overview of the fit performance compared to initial graph:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="fu"><a href="reference/plotPerf.html">plotPerf</a></span>(<span class="no">fit</span>$<span class="no">Pg</span>, <span class="no">data</span>$<span class="no">G</span>,<span class="kw">r</span><span class="kw">=</span><span class="fl">1</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The convergence of <code><a href="https://rdrr.io/pkg/nestor/man/nestor-package.html">nestor()</a></code> can be checked with the plotting function <code><a href="reference/plotConv.html">plotConv()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="fu"><a href="reference/plotConv.html">plotConv</a></span>(<span class="kw">nestorFit</span> <span class="kw">=</span> <span class="no">fit</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>This package provides with a parllel procedure for the computation of several fits of <code><a href="https://rdrr.io/pkg/nestor/man/nestor-package.html">nestor()</a></code> corresponding to a list of possible cliques, with the function <code><a href="reference/List.nestor.html">List.nestor()</a></code>. Below is an example with the list of four cliques previously obtained with the <code><a href="reference/complement_spca.html">complement_spca()</a></code> function:</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">fitList</span><span class="kw">=</span><span class="fu"><a href="reference/List.nestor.html">List.nestor</a></span>(<span class="no">six_cliques</span>, <span class="no">data</span>$<span class="no">Y</span>,<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov2cor</a></span>(<span class="no">sigma_obs</span>), <span class="no">MO</span>,<span class="no">SO</span>,<span class="kw">r</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">eps</span><span class="kw">=</span><span class="fl">1e-3</span>,
                    <span class="kw">maxIter</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">fitList</span>, <span class="no">length</span>))
<span class="co">#&gt;      [,1]</span>
<span class="co">#&gt; [1,]    3</span>
<span class="co">#&gt; [2,]    3</span>
<span class="co">#&gt; [3,]   12</span>
<span class="co">#&gt; [4,]   12</span>
<span class="co">#&gt; [5,]    3</span>
<span class="co">#&gt; [6,]   12</span></pre></div>
<p>The object <code>fitList</code> is simply the list of all the <code><a href="https://rdrr.io/pkg/nestor/man/nestor-package.html">nestor()</a></code> fits. This procedure aborts in case of degenerated behaviour, which happens when the provided clique is too far from truth. Wrong fits can be spotted by their ouput size, as above. We can know see the behaviour of the lowerbound final values with the AUC of each converged fit:</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">fitList</span>, <span class="kw">function</span>(<span class="no">vem</span>){
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">vem</span>)<span class="kw">&gt;</span><span class="fl">4</span>){
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">auc</span><span class="kw">=</span><span class="fu"><a href="reference/auc.html">auc</a></span>(<span class="no">vem</span>$<span class="no">Pg</span>, <span class="no">data</span>$<span class="no">G</span>), <span class="kw">J</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">vem</span>$<span class="no">lowbound</span>$<span class="no">J</span>,<span class="fl">1</span>))
  }
})) <span class="kw">%&gt;%</span> <span class="fu">as_tibble</span>()
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;     auc     J</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1  0.69 -587.</span>
<span class="co">#&gt; 2  0.67 -500.</span>
<span class="co">#&gt; 3  0.77 -498.</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Raphaelle Momal <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/Rmomal/nestor"><img src="https://travis-ci.org/Rmomal/nestor.svg?branch=master" alt="Travis build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Raphaelle Momal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
